<div class="container-fluid">
  <div class="row">
    <div class="col-lg-12">
      <form [formGroup]="userForm">
        <div style="color:black;padding: 20px;" class="card">
          <h5 class="card-title">Cadastrar Novo Usuário</h5>
          <div class="form-group row">
            <label class="col-sm-2 col-form-label">Código de Acesso</label>
            <div class="col-sm-10">
              <input type="text" class="form-control"
                placeholder="Digite aqui o código que será usado para acessar a plataforma"
                formControlName="access_code">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-sm-2 col-form-label">Nome</label>
            <div class="col-sm-10">
              <input type="text" class="form-control" placeholder="Digite aqui o nome do usuário"
                formControlName="name">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-sm-2 col-form-label">Sobrenome</label>
            <div class="col-sm-10">
              <input type="text" class="form-control" placeholder="Digite aqui o sobrenome do usuário"
                formControlName="surname">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-sm-2 col-form-label">Celular</label>
            <div class="col-sm-10">
              <input type="text" class="form-control" [textMask]="{mask: telCelMask}"
                placeholder="Digite o telefone de contato do usuário" formControlName="cellphone">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-sm-2 col-form-label">Email</label>
            <div class="col-sm-10">
              <input type="text" class="form-control" placeholder="Digite aqui o email do usuário"
                formControlName="email">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-sm-2 col-form-label">Cargo</label>
            <div class="col-sm-10">
              <input type="text" class="form-control" placeholder="Digite aqui o cargo do usuário"
                formControlName="role">
            </div>
          </div>
          <div class="form-group row">
            <label class="col-sm-2 col-form-label">Estado</label>
            <div class="col-sm-10">
              <input type="text" class="form-control" placeholder="Digite aqui o estado"
                formControlName="industry_state">
            </div>
          </div>
          <div *ngIf="showEditUserBtn" class="form-group row">
            <label class="col-sm-2 col-form-label">Total de Pontos</label>
            <div class="col-sm-10">
              <input type="text" class="form-control" placeholder="Digite aqui a pontuação"
                formControlName="total_points">
            </div>
          </div>
          <div *ngIf="showEditUserBtn" class="form-group row">
            <label class="col-sm-2 col-form-label">Total de questões respondidas corretamente</label>
            <div class="col-sm-10">
              <input type="text" class="form-control" placeholder="Digite aqui o total de perguntas respondidas corretamente"
                formControlName="total_correct_anwsered_questions">
            </div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <button *ngIf="!showEditUserBtn" class="btn btn-success" style="position: relative;float:right"
                [disabled]="!userForm.valid" (click)="onClickSaveNewUser()">Salvar Usuário <i
                  class="fas fa-save"></i></button>
              <button *ngIf="showEditUserBtn" class="btn btn-success" style="position: relative;float:right"
                [disabled]="!userForm.valid" (click)="onClickSaveEditedUser()">Salvar Edição <i
                  class="fas fa-save"></i></button>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
  <div class="row">
    <div class="col-lg-12">
      <div class="card" style="color:black;padding: 20px;margin-top: 20px;margin-bottom: 20px">
        <h4>Todos os usuários cadastrados - {{allUsers?.length}}</h4>
        <mat-accordion class="example-headers-align">
          <mat-expansion-panel *ngFor="let user of allUsers;let i = index;" [expanded]="step === i"
            (opened)="setStep(i)">
            <mat-expansion-panel-header>
              <mat-panel-title>
                {{user.name | titlecase}}
              </mat-panel-title>
              <mat-panel-description>
                {{user?.access_code}}
                <mat-icon>account_box</mat-icon>
              </mat-panel-description>
            </mat-expansion-panel-header>
            <span>Nome Completo: {{user?.name}} {{user?.surname}}</span><br>
            <span>Email: {{user?.email}}</span><br>
            <span>Telefone de Contato: {{user?.cellphone}}</span><br>
            <span>Indústria / Estado: {{user?.industry_state}}</span><br>
            <span>Cargo: {{user?.role}}</span><br>
            <span>Nº perguntas Respondidas: {{user?.questions_anwsered.length}}</span><br>
            <span>Total perguntas corretas respondidas: {{user?.total_correct_anwsered_questions}}</span><br>
            <span>Pontuação Total: {{user?.total_points}}</span><br>
            <span *ngIf="user?.userPreferences[0]">Preferências:</span>
            <ul *ngIf="user?.userPreferences[0]">
              <li *ngFor="let item of user?.userPreferences">{{item}}</li>
            </ul>
            <div class="row">
              <div class="col-lg-12">
                <button matTooltip="Apagar este usuário" mat-mini-fab color="warn"
                  style="position: relative;float: right" (click)="apagar(user?._id)">
                  <mat-icon>delete_forever</mat-icon>
                </button>
                <button matTooltip="Editar este usuário" mat-mini-fab color="primary"
                  style="position: relative;float: right" (click)="onClickEditUser(user)"><i
                    class="fas fa-pencil-alt"></i></button>
              </div>
            </div>
            <mat-action-row>
              <button *ngIf="i >= 1" mat-button color="warn" (click)="prevStep()">Anterior</button>
              <button *ngIf="i < allUsers.length-1" mat-button color="primary" (click)="nextStep()">Próxima</button>
            </mat-action-row>
          </mat-expansion-panel>
        </mat-accordion>
      </div>
    </div>
  </div>
</div>
